

name: aws checks


on:
    push:
        branches:
            - main
    workflow_dispatch:

permissions:
  id-token: write   #  requesting the JWT
  contents: read    #  required for actions/checkout

jobs:
    aws_login:
      runs-on: ubuntu-latest
      steps:
        - name: login
          uses: aws-actions/configure-aws-credentials@v5.0.0
          with:
            aws-region: ${{ secrets.AWS_REGION }}
            role-to-assume: ${{ secrets.IAM_ROLE }}
        - name: list all s3 buckets
          env:
            AWS-REGION: ${{ secrets.AWS_REGION }}
          run: aws s3 ls